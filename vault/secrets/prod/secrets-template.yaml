# Vault Secrets Template for Production Environment
# This file documents the required secrets structure for the production environment
# Use this template to populate secrets in Vault at the specified paths

# CRITICAL SECURITY NOTES:
# 1. Replace all placeholder values with actual secrets
# 2. Use the sync-secrets.sh script to populate Vault
# 3. NEVER commit actual secret values to Git
# 4. Production secrets MUST be different from dev and staging
# 5. Use strong, unique passwords (minimum 24 characters)
# 6. Enable secret rotation policies
# 7. Restrict access to production secrets to authorized personnel only

---
# Frontend Service Secrets
# Path: secret/data/craftista/prod/frontend/
frontend:
  api-keys:
    session_secret: "REPLACE_WITH_RANDOM_SESSION_SECRET"
    jwt_secret: "REPLACE_WITH_JWT_SECRET"

  config:
    node_env: "production"
    log_level: "warn"
    port: "3000"

---
# Catalogue Service Secrets
# Path: secret/data/craftista/prod/catalogue/
catalogue:
  mongodb-credentials:
    username: "catalogue_user"
    password: "REPLACE_WITH_MONGODB_PASSWORD"
    database: "catalogue"

  mongodb-uri:
    connection_string: "mongodb://catalogue_user:REPLACE_WITH_MONGODB_PASSWORD@mongodb-prod.craftista.local:27017/catalogue?authSource=admin&ssl=true&replicaSet=rs0"

  config:
    flask_env: "production"
    log_level: "WARNING"
    data_source: "mongodb"

---
# Voting Service Secrets
# Path: secret/data/craftista/prod/voting/
voting:
  postgres-credentials:
    username: "voting_user"
    password: "REPLACE_WITH_POSTGRES_PASSWORD"
    database: "voting"

  postgres-uri:
    jdbc_url: "jdbc:postgresql://postgres-prod.craftista.local:5432/voting?ssl=true&sslmode=require"
    connection_string: "postgresql://voting_user:REPLACE_WITH_POSTGRES_PASSWORD@postgres-prod.craftista.local:5432/voting?sslmode=require"

  config:
    spring_profiles_active: "prod"
    log_level: "WARN"

---
# Recommendation Service Secrets
# Path: secret/data/craftista/prod/recommendation/
recommendation:
  redis-credentials:
    password: "REPLACE_WITH_REDIS_PASSWORD"

  redis-uri:
    connection_string: "rediss://:REPLACE_WITH_REDIS_PASSWORD@redis-prod.craftista.local:6379/0"
    host: "redis-prod.craftista.local"
    port: "6379"

  config:
    environment: "production"
    log_level: "warn"

---
# Common Secrets (shared across services)
# Path: secret/data/craftista/prod/common/
common:
  registry:
    dockerhub_username: "REPLACE_WITH_DOCKERHUB_USERNAME"
    dockerhub_password: "REPLACE_WITH_DOCKERHUB_PASSWORD"

  monitoring:
    slack_webhook_url: "REPLACE_WITH_SLACK_WEBHOOK_URL"
    pagerduty_integration_key: "REPLACE_WITH_PAGERDUTY_KEY"

  tls:
    cert: "REPLACE_WITH_TLS_CERT"
    key: "REPLACE_WITH_TLS_KEY"

  backup:
    s3_access_key: "REPLACE_WITH_S3_ACCESS_KEY"
    s3_secret_key: "REPLACE_WITH_S3_SECRET_KEY"
    backup_encryption_key: "REPLACE_WITH_BACKUP_ENCRYPTION_KEY"

---
# Database Connection Details
# These are reference values for documentation purposes
database_endpoints:
  mongodb:
    host: "mongodb-prod.craftista.local"
    port: 27017
    description: "MongoDB cluster for catalogue service (DocumentDB)"
    ssl_enabled: true
    replica_set: "rs0"

  postgresql:
    host: "postgres-prod.craftista.local"
    port: 5432
    description: "PostgreSQL instance for voting service (RDS)"
    ssl_enabled: true
    multi_az: true

  redis:
    host: "redis-prod.craftista.local"
    port: 6379
    description: "Redis cluster for recommendation service (ElastiCache)"
    ssl_enabled: true
    cluster_mode: true

---
# Production Security Requirements:
security_requirements:
  password_policy:
    minimum_length: 24
    require_uppercase: true
    require_lowercase: true
    require_numbers: true
    require_symbols: true
    no_dictionary_words: true

  rotation_policy:
    database_credentials: "90 days"
    api_keys: "180 days"
    tls_certificates: "365 days"
    session_secrets: "30 days"

  access_control:
    vault_policy: "prod-read-only for services, admin for ops team"
    mfa_required: true
    audit_logging: true

  encryption:
    data_at_rest: "AES-256"
    data_in_transit: "TLS 1.3"
    backup_encryption: "AES-256-GCM"

---
# Notes:
# - All passwords MUST be at least 24 characters with mixed case, numbers, and symbols
# - Session secrets should be cryptographically random (use: openssl rand -base64 48)
# - JWT secrets should be cryptographically random (use: openssl rand -base64 96)
# - Database credentials should follow principle of least privilege
# - TLS certificates should be valid for webdemoapp.com and *.webdemoapp.com
# - Use AWS Certificate Manager for TLS certificate management
# - Slack webhook URLs should be obtained from Slack workspace settings
# - Production secrets MUST be different from dev and staging
# - Enable Vault audit logging for all production secret access
# - Implement secret rotation policies using Vault's dynamic secrets
# - Use AWS Secrets Manager integration for RDS/DocumentDB credentials
# - Enable MFA for all production Vault access
# - Restrict production secret access to authorized personnel only
# - Maintain offline backup of root Vault tokens in secure location
